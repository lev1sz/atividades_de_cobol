* Microsoft COBOL Version 4.5        L2.4 revision 002 24-Mar-25 08:53 Page   1
*                                       EX05.CBL
* Options: LIST(EX05.LST) ASMLIST(EX05.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX05.
     3 AUTHOR.        LEVI LIMA BELTRAO.
     4 DATE-WRITTEN.  24/03/2025.
     5 DATE-COMPILED. 24-Mar-25 08:53.
     6 SECURITY.      APENAS O AUTOR PODE MODIFICAR.
     7*REMARKS.       LE OS REGISTROS NO ARQUIVO CADALU
     8*               (NUM, NOME, NOTA1, NOTA2, FALTAS)
     9*               E GRAVA NO ARQUIVO CADAPR (NUM, NOME,
    10*               MEDIA) AQUELES OS REGISTROS QUE TIVEREM
    11*               MEDIA >= 7 E FALTAS <= 18.
    12
    13 ENVIRONMENT DIVISION.
    14 CONFIGURATION SECTION.
    15 SOURCE-COMPUTER. LEVI-PC.
    16 OBJECT-COMPUTER. LEVI-PC.
    17 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    18
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21     SELECT CADALU ASSIGN TO DISK
    22     ORGANIZATION IS LINE SEQUENTIAL.
    23     SELECT CADAPR ASSIGN TO DISK
    24     ORGANIZATION IS LINE SEQUENTIAL.
    25
    26 DATA DIVISION.
    27 FILE SECTION.
    28 FD CADALU
    29     LABEL RECORD ARE STANDARD
    30     VALUE OF FILE-ID IS "CADALU.DAT".
    31
    32 01 REG-ENT.
    33     02 NUM-ENT       PIC 9(05).
    34     02 NOME-ENT      PIC X(20).
    35     02 NOTA1         PIC 9(2)V99.
    36     02 NOTA2         PIC 9(2)V99.
    37     02 FALTAS        PIC 9(02).
    38
    39 FD CADAPR
    40     LABEL RECORD ARE STANDARD
    41     VALUE OF FILE-ID IS "CADAPR.DAT".
    42
    43 01 REG-SAI.
    44     02 NUM-SAI       PIC 9(05).
    45     02 NOME-SAI      PIC X(20).
    46     02 MEDIA         PIC 9(2)V99.
    47
    48 WORKING-STORAGE SECTION.
    49 77 FIM-ARQ        PIC X(03)   VALUE "NAO".
    50 77 SOMA-NOTA      PIC 9(2)V99 VALUE ZEROS.
    51 77 WMEDIA         PIC 9(2)V99 VALUE ZEROS.
    52
    53 PROCEDURE DIVISION.
    54 EXFIX.
    55
    56 PERFORM INICIO.
    57 PERFORM PRINCIPAL
* Microsoft COBOL Version 4.5        L2.4 revision 002 24-Mar-25 08:53 Page   2
*                                       EX05.CBL
    58     UNTIL FIM-ARQ EQUAL "SIM".
    59 PERFORM TERMINO.
    60 STOP RUN.
    61
    62 INICIO.
    63     OPEN INPUT CADALU
    64         OUTPUT CADAPR.
    65     PERFORM LEITURA.
    66
    67 LEITURA.
    68     READ CADALU
    69         AT END
    70         MOVE "SIM" TO FIM-ARQ.
    71
    72 PRINCIPAL.
    73     PERFORM GRAVACAO.
    74     PERFORM LEITURA.
    75
    76 GRAVACAO.
    77     MOVE 0 TO SOMA-NOTA.
    78     MOVE 0 TO WMEDIA.
    79     ADD NOTA1, NOTA2 TO SOMA-NOTA.
    80     DIVIDE SOMA-NOTA BY 2 GIVING WMEDIA.
    81     IF FALTAS NOT > 18 AND WMEDIA NOT < 7 THEN
    82         MOVE NUM-ENT TO NUM-SAI
    83         MOVE NOME-ENT TO NOME-SAI
    84         MOVE WMEDIA TO MEDIA
    85         WRITE REG-SAI.
    86
    87 TERMINO.
    88     CLOSE CADALU
    89           CADAPR.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1048     Code:         385     Dictionary:        1235
