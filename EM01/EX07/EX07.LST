* Microsoft COBOL Version 4.5        L2.4 revision 002 24-Mar-25 16:06 Page   1
*                                       EX07.CBL
* Options: LIST(EX07.LST) ASMLIST(EX07.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX07.
     3 AUTHOR.        LEVI LIMA BELTRAO.
     4 DATE-WRITTEN.  24/03/2025.
     5 DATE-COMPILED. 24-Mar-25 16:06.
     6 SECURITY.      APENAS O AUTOR PODE MODIFICAR.
     7*REMARKS.       LE TODOS OS REGISTROS NO ARQUIVO CADALU
     8*               (NUM, NOME, NOTA1, 2, 3, 4 E SEXO) E SELECIONA
     9*               PARA GRAVACAO NO ARQUIVO CADATU (NUM, NOME,
    10*               MEDIA, SEXO) SOMENTE OS REGISTROS DO SEXO FEMININO
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
    14 SOURCE-COMPUTER. LEVI-PC.
    15 OBJECT-COMPUTER. LEVI-PC.
    16 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    17
    18 INPUT-OUTPUT SECTION.
    19 FILE-CONTROL.
    20     SELECT CADALU ASSIGN TO DISK
    21     ORGANIZATION IS LINE SEQUENTIAL.
    22     SELECT CADATU ASSIGN TO DISK
    23     ORGANIZATION IS LINE SEQUENTIAL.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27 FD CADALU
    28     LABEL RECORD ARE STANDARD
    29     VALUE OF FILE-ID IS "CADALU.DAT".
    30
    31 01 REG-ENT.
    32     02 NUM-ENT             PIC 9(05).
    33     02 NOME-ENT            PIC X(20).
    34     02 NOTA1               PIC 9(2)V99.
    35     02 NOTA2               PIC 9(2)V99.
    36     02 NOTA3               PIC 9(2)V99.
    37     02 NOTA4               PIC 9(2)V99.
    38     02 SEXO-ENT                PIC X(01).
    39
    40 FD CADATU
    41     LABEL RECORD ARE STANDARD
    42     VALUE OF FILE-ID IS "CADATU.DAT".
    43
    44 01 REG-SAI.
    45     02 NUM-SAI             PIC 9(05).
    46     02 NOME-SAI            PIC X(20).
    47     02 MEDIA               PIC 9(2)V99.
    48     02 SEXO-SAI            PIC X(01).
    49
    50 WORKING-STORAGE SECTION.
    51 77 FIM-ARQ                 PIC X(03)       VALUE IS "NAO".
    52 77 SOMA-NOTA               PIC 9(2)V99.
    53 77 WMEDIA                  PIC 9(2)V99.
    54
    55 PROCEDURE DIVISION.
    56 EXFIX.
    57
* Microsoft COBOL Version 4.5        L2.4 revision 002 24-Mar-25 16:06 Page   2
*                                       EX07.CBL
    58 PERFORM INICIO.
    59 PERFORM PRINCIPAL
    60     UNTIL FIM-ARQ EQUAL "SIM".
    61 PERFORM TERMINO.
    62 STOP RUN.
    63
    64 INICIO.
    65     OPEN INPUT CADALU
    66         OUTPUT CADATU.
    67     PERFORM LEITURA.
    68
    69 LEITURA.
    70     READ CADALU
    71         AT END
    72         MOVE "SIM" TO FIM-ARQ.
    73
    74 PRINCIPAL.
    75     PERFORM GRAVACAO.
    76     PERFORM LEITURA.
    77
    78 GRAVACAO.
    79     IF SEXO-ENT EQUAL "F" OR SEXO-ENT EQUAL "f" THEN
    80        MOVE ZEROS     TO SOMA-NOTA
    81        MOVE ZEROS     TO WMEDIA
    82        ADD NOTA1, NOTA2, NOTA3, NOTA4 TO SOMA-NOTA
    83        DIVIDE SOMA-NOTA BY 4 GIVING WMEDIA
    84        MOVE NUM-ENT   TO   NUM-SAI
    85        MOVE NOME-ENT  TO   NOME-SAI
    86        MOVE WMEDIA    TO   MEDIA
    87        MOVE SEXO-ENT  TO   SEXO-SAI
    88        WRITE REG-SAI.
    89
    90 TERMINO.
    91     CLOSE CADALU
    92           CADATU.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1056     Code:         397     Dictionary:        1320
