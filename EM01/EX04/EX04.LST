* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Mar-25 17:13 Page   1
*                                       EX04.CBL
* Options: LIST(EX04.LST) ASMLIST(EX04.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX04.
     3 AUTHOR.        LEVI-PC.
     4 DATE-WRITTEN.  23/03/2025.
     5 DATE-COMPILED. 23-Mar-25 17:13.
     6 SECURITY.      APENAS O AUTOR PODE MODIFICAR.
     7*REMARKS.       LE OS REGISTROS NO ARQUIVO
     8*               CADCLI1(COD-ENT,NOME-ENT,SEXO)
     9*               E GRAVA NO ARQUIVO CADCLI2(COD-SAI,NOME-SAI)
    10*               SOMENTE OS REGISTROS MASCULINOS.
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
    14 SOURCE-COMPUTER. LEVI-PC.
    15 OBJECT-COMPUTER. LEVI-PC.
    16 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    17
    18 INPUT-OUTPUT SECTION.
    19 FILE-CONTROL.
    20     SELECT CADCLI1 ASSIGN TO DISK
    21     ORGANIZATION IS LINE SEQUENTIAL.
    22     SELECT CADCLI2 ASSIGN TO DISK
    23     ORGANIZATION IS LINE SEQUENTIAL.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27 FD CADCLI1
    28     LABEL RECORD ARE STANDARD
    29     VALUE OF FILE-ID IS "CADCLI1.DAT".
    30
    31 01 REG-ENT.
    32     02 COD-ENT  PIC 9(05).
    33     02 NOME-ENT PIC X(20).
    34     02 SEXO     PIC X(01).
    35
    36 FD CADCLI2
    37     LABEL RECORD ARE STANDARD
    38     VALUE OF FILE-ID IS "CADCLI2.DAT".
    39
    40 01 REG-SAI.
    41     02 COD-SAI  PIC 9(05).
    42     02 NOME-SAI PIC X(20).
    43
    44 WORKING-STORAGE SECTION.
    45 77 FIM-ARQ PIC X(03) VALUE "NAO".
    46
    47 PROCEDURE DIVISION.
    48 EXFIX.
    49
    50 PERFORM INICIO.
    51 PERFORM PRINCIPAL
    52        UNTIL FIM-ARQ EQUAL "SIM".
    53 PERFORM TERMINO.
    54 STOP RUN.
    55
    56 INICIO.
    57     OPEN INPUT CADCLI1
* Microsoft COBOL Version 4.5        L2.4 revision 002 23-Mar-25 17:13 Page   2
*                                       EX04.CBL
    58         OUTPUT CADCLI2.
    59     PERFORM  LEITURA.
    60
    61 LEITURA.
    62     READ CADCLI1
    63         AT END
    64         MOVE "SIM" TO FIM-ARQ.
    65
    66 PRINCIPAL.
    67     PERFORM GRAVACAO.
    68     PERFORM LEITURA.
    69
    70 GRAVACAO.
    71     IF SEXO EQUAL "M" THEN
    72         MOVE COD-ENT TO COD-SAI
    73         MOVE NOME-ENT TO NOME-SAI
    74         WRITE REG-SAI.
    75     NEXT SENTENCE.
    76
    77 TERMINO.
    78     CLOSE CADCLI1
    79           CADCLI2.
    80
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1016     Code:         320     Dictionary:        1034
